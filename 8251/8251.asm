CODE    SEGMENT PARA 'CODE'
        ASSUME CS:CODE, DS:DATA, SS:STAK
STAK    SEGMENT PARA STACK 'STACK'
        DW 20 DUP(?)
STAK    ENDS

DATA    SEGMENT PARA 'DATA'
ENTRY   DB 48D,47D,49D
DATA    ENDS


START:
        MOV AX, DATA
	MOV DS, AX

	MOV DX, 0015Ah
	MOV AL, 4DH
	OUT DX, AL

	MOV AL, 40H
	OUT DX, AL
	
	MOV AL, 4DH
	OUT DX, AL
	
	MOV AL, 00010101B
	OUT DX, AL
	
SONSUZ:
        XOR DI,DI
	MOV DX, 015AH	
HAZIRMI:
	IN AL, DX
	AND AL, 02D
	JE HAZIRMI
	
	MOV DX, 0158H
	IN AL, DX	
	SHR AL, 1H 	
	
	CMP AL, 48D
	JZ YAZDIR_BASLA
	
	XOR DI,DI
	MOV BL, ENTRY[DI+1]
	MOV BH, ENTRY[DI]
	MOV ENTRY[DI+2], BL
	MOV ENTRY[DI+1], BH
	MOV ENTRY[DI], AL
	
	CMP SI, 3
	JZ DEVAM
        INC SI 
DEVAM:	
	JMP SONSUZ
	

YAZDIR_BASLA:
        MOV CX, SI
	CMP SI,0
	JZ SONSUZ
	XOR DI,DI
YAZDIR:            	
        MOV DX, 015AH
L2:	
	IN AL, DX
	AND AL, 01H
	JZ L2	
	
	MOV DX, 0158H
	MOV AL, ENTRY[DI]
	
        INC DI	
	OUT DX, AL	
	LOOP YAZDIR
	
	MOV SI,0
		
        JMP SONSUZ
EXIT:
	RETF
CODE    ENDS
        END START